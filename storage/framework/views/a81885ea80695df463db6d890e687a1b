<?php $__env->startSection('header'); ?>
    <?php echo $__env->make('util.m-topbar', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
	<div class="container">
		<div class="col-lg-12">
			<ol class="breadcrumb" style=" margin-left: 1.5rem; ">
				<li><label>Inventory</label>
				<li><a href="<?php echo e(route('home')); ?>" class="active">Home</a></li>
				<li><a href="<?php echo e(route('category.show', [$device->category->slug])); ?>" class="active"><?php echo e($device->category->name); ?></a></li>
				<li><label><?php echo e($device->name); ?></label>
			</ol>
			<?php if(Session::has('success_msg')): ?>
				<div class="alert alert-success" role="alert" style=" margin-left: 1.5rem; ">
				<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<?php echo e(Session::get('success_msg')); ?>

				</div>
			<?php endif; ?>
		</div>
	</div>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('content'); ?>
<div class="container">
    <div class="col-lg-3">
   		<div class="btn-group-vertical col-lg-12" role="group">
   			<a role="button" class="btn btn-default col-lg-12 text-left" href="#"  data-toggle='modal' data-target='#noteStore' ><span class="glyphicon glyphicon-pencil"></span> Make a Note</a>
			<?php if($device->owner_id != NULL): ?>
				<a role="button" class="btn btn-default col-lg-12 text-left" data-toggle='modal' data-target='#disassociate_device' href="#"><span class="glyphicon glyphicon-remove"></span> Disassociate</a>
			<?php else: ?>
				<a role="button" id="grp" class="btn btn-default col-lg-12 text-left cli" data-toggle='modal' data-target='#associate_device' href="#"><span class="glyphicon glyphicon-tag"></span> Associate</a>
			<?php endif; ?>
			<a role="button" class="btn btn-default col-lg-12 text-left" href="#" data-toggle='modal' data-target='#change_status'><span class="glyphicon glyphicon-repeat"></span> Change Status</a>
			<a role="button" class="btn btn-default col-lg-12 text-left" href="#" data-toggle="modal" data-target="#deleteDevice"><span class="glyphicon glyphicon-trash"></span> Delete <?php echo e($device->name); ?></a>
			<a role="button" class="btn btn-default col-lg-12 text-left" href="<?php echo e(route('category.show', [$device->category->slug])); ?>"><span class="glyphicon glyphicon-chevron-left"></span> Return to <?php echo e($device->category->name); ?></a>
		</div>

    	<div class="btn-group-vertical col-lg-12" role="group" style="top: 1rem;">
			<a role="button" id="grp" class="btn btn-default col-lg-12 text-left" href="<?php echo e(route('status.index')); ?>">Status: <span class="right"><?php echo e($device->status->status); ?></span></a>
			<?php if($device->owner_id != NULL): ?>
				<a role="button" id="grp" class="btn btn-default col-lg-12 text-left" data-toggle='modal' title="<?php echo e($device->owner->firstName . ' ' . $device->owner->lastName); ?>" href="<?php echo e(route('owner.show', [$device->owner->slug])); ?>">Owner: <span class="right"><?php echo e(str_limit($device->owner->firstName . ' '. $device->owner->lastName, $limit = 16, $end = '...')); ?></span></a>
			<?php else: ?>
				<a role="button" id="grp" class="btn btn-default col-lg-12 text-left" data-toggle='modal' data-target='#associate_device' href="#">Owner: <span class="right"><?php echo e($device->availability); ?></span></a>
			<?php endif; ?>
		</div>

		<div class="btn-group-vertical col-lg-12" role="group" style="top: 2rem;">
		<a role="button" id="grp" class="btn btn-default col-lg-12 text-center rm-hvr" href="#">Click here to edit all</a></a>
			<?php foreach($device->information as $key=>$device_field): ?>
				<a tabindex="<?php echo e(++$key); ?>" role="button" id="grp" class="btn btn-default col-lg-12 text-left" data-popover="true" data-html="true" data-trigger="focus"
				data-content="<a class='glyphicon glyphicon-pencil' onclick='editInfo(<?php echo e($device_field->id); ?>, &quot;<?php echo e($device_field->value); ?>&quot;, &quot;<?php echo e($device_field->field->category_label); ?>&quot;)' title=&quot;Edit <?php echo e($device->name); ?> <?php echo e($device_field->field->category_label); ?>&quot;  data-toggle='modal' data-target='#editInfo'></a><a class='glyphicon glyphicon-trash' title=&quot;Delete <?php echo e($device->name); ?> <?php echo e($device_field->field->category_label); ?>&quot; onclick='deleteInfo(<?php echo e($device_field->id); ?>, &quot;<?php echo e($device_field->value); ?>&quot;, &quot;<?php echo e($device_field->field->category_label); ?>&quot;)' data-toggle='modal' data-target='#deleteInfo'></a>"
				> <?php echo e($device_field->field->category_label); ?>:<span class="right"><?php echo e($device_field->value); ?></span></a>
			<?php endforeach; ?>
		</div>
	</div>

     <div class="col-lg-9 col-md-offset-center-2" >
        <div class="panel panel-default col-lg-12" style="border-color: #ccc;">
			<h3><?php echo e($device->category->name . ": " . $device->name); ?></h3>
        </div>

		<?php if($device->status_id != '' || $device->status_id != 0): ?>
		<div class="panel panel-default col-lg-12" style="border-color: #ccc;">
			<div class="page-header">
				<h3>Status: <?php echo e($device->status->status); ?></h3>
			</div>
			Status Description:
			<div class="well well-sm" name="note"><i><?php echo e($device->status->description); ?></i></div>
		</div>
		<?php endif; ?>

		<div class="panel panel-default col-lg-12" style="border-color: #ccc;">
			<div class="page-header">
				<h3>Associate/Dissociate History</h3>
			</div>
			<br/>
			<table id="assoc_history"></table>
			<br/>
		</div>

		<div class="panel panel-default col-lg-12" style="border-color: #ccc;">
			<div class="page-header">
				<h3>Status History</h3>
			</div>
			<br/>
			<table id="device_status"></table>
			<br/>
		</div>

        <div class="panel panel-default col-lg-12" style="border-color: #ccc;">
			<div class="page-header">
				<h3>Notes</h3>
			</div>
			<label for="">Recent Note:</label>
			<?php if(count($note) > 0): ?>
			<div class="well well-sm" name="note"><i><?php echo e(str_replace("&apos;", "'", $note->note)); ?></i></div>
			<br/>
			<?php else: ?>
			<div class="well well-sm" name="note"><i>There is no note to display...</i></div>
			<br/>
			<?php endif; ?>
			<table id="note_history"></table>
			<br/>
		</div>

    </div>
 </div>

<?php /* EDIT INFORMATION MODAL */ ?>
 <div class="modal fade" id="editInfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<?php echo Form::open(['route'=>['information/update']]); ?>

	<div class="modal-dialog">
		<div class="modal-content ">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="myModalLabel">Edit <?php echo e($device->name); ?> <span id="category_label"></span> </h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<div class="row">
						<div class="col-md-12 center col-lg-offset-1">
							<div class="form-group">
								<label class="col-md-4 control-label" id="catgry_label"></label>
								<div class="col-md-6">
									<input type="string" class="form-control" id="info_value" name="value" value="<?php echo e(old('value')); ?>">
								</div>
							</div>
							<br/><br/>
						</div>
					</div>
				</div>
			</div>
			<br/>
			<div class="modal-footer">
				<?php echo Form::hidden('inf_id', '', ['id'=>'info_id']); ?>

				<?php echo Form::hidden('device_id', $device->id); ?>

				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="submit" class="btn btn-primary">Save changes</button>
			</div>
		</div>
	</div>
	<?php echo Form::close(); ?>

</div>

<?php /* CREATE NOTE MODAL */ ?>
 <div class="modal fade" id="noteStore" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<?php echo Form::open(['route'=>['note.store']]); ?>

	<div class="modal-dialog">
		<div class="modal-content ">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="myModalLabel"><span><a class="glyphicon glyphicon-pencil" href=""></a></span> Create a Note <span id="category_label"></span> </h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<div class="row">
						<div class="col-md-12 center col-lg-offset-1">
							<div class="form-group">
								<label class="col-md-4 control-label"><i>Your Note*</i></label>
								<div class="col-md-6">
									<input type="string" class="form-control" id="" name="note" value="<?php echo e(old('value')); ?>">
								</div>
							</div>
							<br/><br/>
						</div>
					</div>
				</div>
			</div>
			<br/>
			<div class="modal-footer">
				<?php echo Form::hidden('user_id', Auth::user()->id); ?>

				<?php echo Form::hidden('device_id', $device->id); ?>

				<?php if(count($note) > 0): ?>
				<?php echo Form::hidden('note_id', $note->id); ?>

				<?php endif; ?>
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="submit" class="btn btn-primary">Save changes</button>
			</div>
		</div>
	</div>
	<?php echo Form::close(); ?>

</div>

<?php /* ASSOCIATE DEVICE MODAL */ ?>
 <div class="modal fade" id="associate_device" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<?php echo Form::open(['route' => ['device_associate', $device->id]]); ?>

	<div class="modal-dialog">
		<div class="modal-content ">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="myModalLabel">Associate <?php echo e($device->name); ?> </h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<div class="row">
						<div class="col-md-12 center col-lg-offset-1">
							<div class="form-group">
								<label class="col-md-4 control-label">Owners</label>
								<div class="col-md-6">
									<div id="groupList" name="owner_id"></div>
								</div>
							</div>
							<br/><br/>
						</div>
					</div>
				</div>
			</div>
			<br/>
			<div class="modal-footer">
				<button type="submit" class="btn btn-primary">Associate Device</button>
			</div>
		</div>
	</div>
	<?php echo Form::close(); ?>

</div>

<?php /* DISASSOCIATE DEVICE MODAL */ ?>
 <div class="modal fade" id="disassociate_device" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<?php echo Form::open(['route' => ['device_disassociate', $device->id]]); ?>

	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="myModalLabel">Disassociate <?php echo e($device->name); ?> </h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<div class="row">
						<div class="col-md-12 center col-lg-offset-1">
							<div class="form-group">
								<label class="col-md-4 control-label">Owner</label>
								<div class="col-md-6">
									<?php if($device->owner_id != '' || $device->owner_id != 0): ?>
									<label for=""><?php echo e($device->owner->firstName . ' ' . $device->owner->lastName); ?></label>
									<?php endif; ?>
								</div>
							</div>
							<br/><br/>
						</div>
					</div>
				</div>
			</div>
			<br/>
			<div class="modal-footer">
				<button type="submit" class="btn btn-primary">Disassociate Device</button>
			</div>
		</div>
	</div>
	<?php echo Form::close(); ?>

</div>

<?php /* CHANGE STATUS MODAL */ ?>
 <div class="modal fade" id="change_status" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<?php echo Form::open(['route' => ['change_status', $device->id]]); ?>

	<div class="modal-dialog">
		<div class="modal-content ">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="myModalLabel">Change <?php echo e($device->name); ?> Status</h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<div class="row">
						<div class="col-md-12 center col-lg-offset-1">
							<div class="form-group">
								<label class="col-md-4 control-label">Owners</label>
								<div class="col-md-6">
									<div id="statusList" name="status_id"></div>
								</div>
							</div>
							<br/><br/>
						</div>
					</div>
				</div>
			</div>
			<br/>
			<div class="modal-footer">
				<button type="submit" class="btn btn-primary">Change Status</button>
			</div>
		</div>
	</div>
	<?php echo Form::close(); ?>

</div>


<!-- Delete Contact Modal -->
<div class="modal fade" name="deleteDevice" id="deleteDevice" tabindex="-1" role="dialog" aria-labelledby="myModalLabels" aria-hidden="true">
	<?php echo Form::open(['method'=>'DELETE', 'route'=>['device.destroy', $device->slug]]); ?>

	<div class="modal-dialog">
		<div class="modal-content ">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="myModalLabels">Delete <?php echo e($device->name); ?></h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<div class="row">
						<div class="col-md-12 center col-lg-offset-1">
							<div class="form-group">
								<label class="col-md-12 control-label">Are you sure you want to delete [ Device :: <?php echo e($device->name); ?> ]</label>
							</div>
						</div>
					</div>
				</div>
			</div>
			<br/>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="submit" class="btn btn-danger">Delete</button>
			</div>
		</div>
	</div>
	<?php echo Form::close(); ?>

</div>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('script'); ?>
<script>
	var originalLeave = $.fn.popover.Constructor.prototype.leave;
	$.fn.popover.Constructor.prototype.leave = function(obj){
		var self = obj instanceof this.constructor ?
		obj : $(obj.currentTarget)[this.type](this.getDelegateOptions()).data('bs.' + this.type)
		var container, timeout;

		originalLeave.call(this, obj);

		if(obj.currentTarget) {
			container = $(obj.currentTarget).siblings('.popover')
			timeout = self.timeout;
			container.one('mouseenter', function(){
				//We entered the actual popover – call off the dogs
				clearTimeout(timeout);
				//Let's monitor popover content instead
				container.one('mouseleave', function(){
					$.fn.popover.Constructor.prototype.leave.call(self, self);
				});
			})
		}
	};

	function editInfo(inf_id, value, categry_label) {
		document.getElementById("info_id").value = inf_id;
		document.getElementById('info_value').value = value;
		document.getElementById('category_label').innerHTML = categry_label;
		document.getElementById('catgry_label').innerHTML = categry_label;
	}

    $('body').popover({ selector: '[data-popover]', trigger: 'hover', placement: 'right', delay: {show: 50, hide: 50}});

	$.getJSON("<?php echo e(route('fetchAvailableOwners', [$device->category->id])); ?>", function(data) {
		var datalist = [];
		console.log(data);

		$.each(data, function(key, val) {
			datalist.push({value: val.id, text: val.name});
		});

		$('#groupList').multilist({
			single: true,
			labelText: 'Select Group',
			datalist: datalist,
			enableSearch: true
		});
	});

	$.getJSON("<?php echo e(route('fetch_all_status')); ?>", function(data) {
		var datalist = [];
		console.log(data);

		$.each(data, function(key, val) {
			datalist.push({value: val.id, text: val.status});
		});

		$('#statusList').multilist({
			single: true,
			labelText: 'Select Status',
			datalist: datalist,
			enableSearch: true
		});
	});

	// DEVICE STATUSES
    $.getJSON("<?php echo e(route('fetch_device_statuses', [$device->id])); ?>", function(data) {
		$('#device_status').dataTable({
			"aaData": data,
			"lengthMenu": [[25, 50, 100, -1], [25, 50, 100, "All"]],
			"oLanguage": {
				"sEmptyTable": "No Status History to be shown...",
				"sLengthMenu": "No. of Status History _MENU_",
				"oPaginate": {
				"sFirst": "First ", // This is the link to the first
				"sPrevious": "&#8592; Previous", // This is the link to the previous
				"sNext": "Next &#8594;", // This is the link to the next
				"sLast": "Last " // This is the link to the last
				}
			},
			//DISPLAYS THE VALUE
			//sTITLE - HEADER
			//MDATAPROP - TBODY
			"aoColumns":
			[
				{"sTitle": "Status ID", "width":"15%" ,"mDataProp": "id", "sClass": "size-14"},
				{"sTitle": "Status", "mDataProp": "status"},
				{"sTitle": "Description", "mDataProp": "description"},
				{"sTitle": "Changed By", "mDataProp": "user_name"},
				{"sTitle": "Date Changed", "mDataProp": "created_at"}

			],
			"aoColumnDefs":
			[
				//FORMAT THE VALUES THAT IS DISPLAYED ON mDataProp
				//ID
				{ "bSortable": false, "aTargets": [ 0 ] },
				{
					"aTargets": [ 0 ], // Column to target
					"mRender": function ( data, type, full ) {
					// 'full' is the row's data object, and 'data' is this column's data
					// e.g. 'full[0]' is the comic id, and 'data' is the comic title
					return '<label class="text-center size-14">' + data + '</label>';
					}
				},
				//DEVICE SLUG
				{
					"aTargets": [ 1 ], // Column to target
					"mRender": function ( data, type, full ) {
						var url = '<?php echo e(route('device.edit', ":slug")); ?>';
						url = url.replace(':slug', full["slug"]);
						// 'full' is the row's data object, and 'data' is this column's data
						// e.g. 'full[0]' is the comic id, and 'data' is the comic title
						return "<a href='"+url+"' class='size-14 text-left'>" + data + "</a>";
					}
				},
				//DATE CHANGED
				{
					"aTargets": [ 2 ], // Column to target
					"mRender": function ( data, type, full ) {
					// 'full' is the row's data object, and 'data' is this column's data
					// e.g. 'full[0]' is the comic id, and 'data' is the comic title
					return '<label class="text-center size-14"> ' + data + ' </label>';
					}
				},
				{
					"aTargets": [ 3 ], // Column to target
					"mRender": function ( data, type, full ) {
					var url = '<?php echo e(route('user.edit', ":slug")); ?>';
					url = url.replace(':slug', full["slug"]);
					// 'full' is the row's data object, and 'data' is this column's data
					// e.g. 'full[0]' is the comic id, and 'data' is the comic title
					return '<a href="'+url+'" class="size-14 text-left">' + data + '</a>';
					}
				},
				{
					"aTargets": [ 4 ], // Column to target
					"mRender": function ( data, type, full ) {
					// 'full' is the row's data object, and 'data' is this column's data
					// e.g. 'full[0]' is the comic id, and 'data' is the comic title
					return '<label class="text-center size-14"> ' + data + ' </label>';
					}
				},
			],

			"fnDrawCallback": function( oSettings ) {
				/* Need to redo the counters if filtered or sorted */
				if ( oSettings.bSorted || oSettings.bFiltered )
				{
					for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )
					{
						$('td:eq(0)', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( "<label>" + (i+1) + "</label>" );
					}
				}
			}
		});
	$('div.dataTables_filter input').attr('placeholder', 'Filter Status');
	});

	// DEVICE ASSOC HISTORY
	$.getJSON("<?php echo e(route('device_assoc_history', [$device->id])); ?>", function(data) {
		$('#assoc_history').dataTable({
			"aaData": data,
			"lengthMenu": [[25, 50, 100, -1], [25, 50, 100, "All"]],
			"oLanguage": {
			"sEmptyTable": "No Associate/Dissociate History to be shown...",
				"sLengthMenu": "No. of Associate/Dissociate _MENU_",
				"oPaginate": {
				"sFirst": "First ", // This is the link to the first
				"sPrevious": "&#8592; Previous", // This is the link to the previous
				"sNext": "Next &#8594;", // This is the link to the next
				"sLast": "Last " // This is the link to the last
				}
			},
			//DISPLAYS THE VALUE
			//sTITLE - HEADER
			//MDATAPROP - TBODY
			"aoColumns":
			[
				{"sTitle": "#", "width":"2%","mDataProp": "id", "sClass": "size-14"},
				{"sTitle": "Owner", "width":"20%","mDataProp": "name"},
				{"sTitle": "Assigned By", "width":"20%","mDataProp": "user_name"},
				{"sTitle": "Action", "width":"20%","mDataProp": "action"},
				{"sTitle": "Date Associated/Dissociated", "width":"38%", "mDataProp": "created_at"}
			],
			"aoColumnDefs":
			[
				//FORMAT THE VALUES THAT IS DISPLAYED ON mDataProp
				//ID
				{ "bSortable": false, "aTargets": [ 0 ] },
				{
					"aTargets": [ 0 ], // Column to target
					"mRender": function ( data, type, full ) {
					// 'full' is the row's data object, and 'data' is this column's data
					// e.g. 'full[0]' is the comic id, and 'data' is the comic title
					return '<label class="text-center size-14">' + data + '</label>';
					}
				},
				// OWNER SLUG
				{
					"aTargets": [ 1 ], // Column to target
					"mRender": function ( data, type, full ) {
						var url = '<?php echo e(route('owner.show', ":slug")); ?>';
						url = url.replace(':slug', full["slug"]);
						// 'full' is the row's data object, and 'data' is this column's data
						// e.g. 'full[0]' is the comic id, and 'data' is the comic title
						return "<a href='"+url+"' class='size-14 text-left'  data-popover='true' data-html='true' data-trigger='hover' data-content='Name: <a>" + full['fullname'] + "</a> <br/> Campaign: <a>" + full['campaign'] + "</a>'>" + data + "</a>";
					}
				},
				// ASSIGNED BY
				{
					"aTargets": [ 2 ], // Column to target
					"mRender": function ( data, type, full ) {
						var url = '<?php echo e(route('user.show', ":id")); ?>';
						url = url.replace(':id', full["user_id"]);
						// 'full' is the row's data object, and 'data' is this column's data
						// e.g. 'full[0]' is the comic id, and 'data' is the comic title
						return "<a href='"+url+"' class='size-14 text-left'  data-popover='true' data-html='true' data-trigger='hover' data-content='Name: <a>" + full['user_name'] + "</a> <br/> User Type: <a>" + full['user_type'] + "</a>'>" + data + "</a>";
					}
				},
				{
					"aTargets": [ 3 ], // Column to target
					"mRender": function ( data, type, full ) {
					// 'full' is the row's data object, and 'data' is this column's data
					// e.g. 'full[0]' is the comic id, and 'data' is the comic title
					return '<label class="text-center size-14"> ' + data + ' </label>';
					}
				},
				{
					"aTargets": [ 4 ], // Column to target
					"mRender": function ( data, type, full ) {
					// 'full' is the row's data object, and 'data' is this column's data
					// e.g. 'full[0]' is the comic id, and 'data' is the comic title
					return '<label class="text-center size-14"> ' + data + ' </label>';
					}
				},
			],

			"fnDrawCallback": function( oSettings ) {
				/* Need to redo the counters if filtered or sorted */
				if ( oSettings.bSorted || oSettings.bFiltered )
				{
					for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )
					{
						$('td:eq(0)', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( "<label>" + (i+1) + "</label>" );
					}
				}
			}
		});
	$('div.dataTables_filter input').attr('placeholder', 'Filter Associate/Dissociate');
	});

	/* NOTE DATA TABLE */
	$.getJSON("<?php echo e(route('note_history', [$device->id])); ?>", function(data) {
		$('#note_history').dataTable({
			"bSort": false,
			"aaData": data,
			"lengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
			"oLanguage": {
			"sEmptyTable": "There's no Note to be shown...",
				"sLengthMenu": "No. of Note to be shown _MENU_",
				"oPaginate": {
				"sFirst": "First ", // This is the link to the first
				"sPrevious": "&#8592; Previous", // This is the link to the previous
				"sNext": "Next &#8594;", // This is the link to the next
				"sLast": "Last " // This is the link to the last
				}
			},
			//DISPLAYS THE VALUE
			//sTITLE - HEADER
			//MDATAPROP - TBODY
			"aoColumns":
			[
				{"sTitle": "#", "width":"2%","mDataProp": "id", "sClass": "size-14"},
				{"sTitle": "Note by", "width":"10%","mDataProp": "name"},
				{"sTitle": "Note", "width":"20%","mDataProp": "note"},
				{"sTitle": "Date Created", "width":"8%", "mDataProp": "created_at"}
			],
			"aoColumnDefs":
			[
				//FORMAT THE VALUES THAT IS DISPLAYED ON mDataProp
				//ID
				{ "bSortable": false, "aTargets": [ 0 ] },
				{
					"aTargets": [ 0 ], // Column to target
					"mRender": function ( data, type, full ) {
					// 'full' is the row's data object, and 'data' is this column's data
					// e.g. 'full[0]' is the comic id, and 'data' is the comic title
					return '<label class="text-center size-14">' + data + '</label>';
					}
				},
				//CATEGORY SLUG
				{
					"aTargets": [ 1 ], // Column to target
					"mRender": function ( data, type, full ) {
						var url = '<?php echo e(route('user.show', ":id")); ?>';
						url = url.replace(':id', full["user_id"]);
						// 'full' is the row's data object, and 'data' is this column's data
						// e.g. 'full[0]' is the comic id, and 'data' is the comic title
						return "<a href='"+url+"' class='size-14 text-left'  data-popover='true' data-html='true' data-trigger='hover' data-content='Name: <a>" + full['name'] + "</a> <br/> User Type: <a>" + full['user_type'] + "</a>'>" + data + "</a>";
					}
				},
				//CATEGORY RECENT UPDATE
				{
					"aTargets": [ 2 ], // Column to target
					"mRender": function ( data, type, full ) {
						var url = '<?php echo e(route('user.show', ":id")); ?>';
						url = url.replace(':id', full["user_id"]);
						// 'full' is the row's data object, and 'data' is this column's data
						// e.g. 'full[0]' is the comic id, and 'data' is the comic title
						return "<a href='"+url+"' class='size-14 text-left'  data-popover='true' data-html='true' data-trigger='hover' data-content='" + full["fullnote"] + "'>" + data + "</a>";
					}
				},
				{
					"aTargets": [ 3 ], // Column to target
					"mRender": function ( data, type, full ) {
					// 'full' is the row's data object, and 'data' is this column's data
					// e.g. 'full[0]' is the comic id, and 'data' is the comic title
					return '<label class="text-center size-14"> ' + data + ' </label>';
					}
				},
			],

			"fnDrawCallback": function( oSettings ) {
				/* Need to redo the counters if filtered or sorted */
				if ( oSettings.bSorted || oSettings.bFiltered )
				{
					for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )
					{
						$('td:eq(0)', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( "<label>" + (i+1) + "</label>" );
					}
				}
			}
		});
	$('div.dataTables_filter input').attr('placeholder', 'Type your Filter');
	});
</script>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('app', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>